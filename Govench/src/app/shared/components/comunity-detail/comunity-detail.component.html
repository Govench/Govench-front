<div class="container-fluid">
  <div class="row encabezado">
    <div class="col-md-2 atras">
      <button class="btn" (click)="volverComunidades()"><i class="fa-solid fa-chevron-left fa-2xl"
          style="color: #ffffff;"></i> Atrás</button>
    </div>
    <div class="row comentarios">
        <strong>Comentarios: </strong>
        <div *ngIf="comunitieDetail.post.length!==0 ; else noComent">
            <div class="comentario" *ngFor="let post of comunitieDetail.post">
                      <img
                        *ngIf="post.user?.profileImageUrl; else defaultImage"
                        [src]="post.user?.profileImageUrl"
                        alt="Profile Image"
                        class="avatar"
                      />
                      <ng-template #defaultImage>
                        <img
                          src="https://banffventureforum.com/wp-content/uploads/2019/08/no-photo-icon-22.png"
                          alt="Profile Image"
                          class="avatar"
                        />
                      </ng-template>
                <div class="comentario-contenido">
                    <p class="autor">{{post.autor.name}}</p>
                    <p class="email">{{post.autor.email}}</p>
                    <p class="body text-dark">{{post.body}}</p>
                    <p class="fecha">Fecha: {{post.created}}</p>
                </div>
                <div class="col">
                    <p class="fecha">Actualizado: {{post.updated}}</p>
                </div>
                <div *ngIf="post.autor.id===MyId" class="col">
                  <button class="btn btn-outline-danger m-1" (click)="deletePostFromCommunity(post.comunidadId,post.id)">Eliminar</button>
                  <button class="btn btn-outline-secondary m-1" data-bs-toggle="modal" data-bs-target="#exampleModal" (click)="guardarIdPost(post.id)">Editar</button>
              </div>

              <div class="modal fade" id="exampleModal"  tabindex="-1" aria-labelledby="editPostModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h1 class="modal-title fs-5 text-dark " id="editPostModalLabel">Editar Post</h1>
                      <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                      <form #editForm="ngForm">
                        <div class="mb-3">
                          <label for="postBody" class="form-label">Nuevo cuerpo del post</label>
                          <textarea
                            id="postBody"
                            name="postBody"
                            [(ngModel)]="postBody"
                            class="form-control"
                            rows="3"
                            required
                            placeholder="Escribe el nuevo contenido aquí"
                          ></textarea>
                        </div>
                      </form>
                    </div>
                    <div class="modal-footer">
                      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                      <button
                        type="button"
                        class="btn btn-primary"
                        [disabled]="!editForm.valid"
                        (click)="savePostChanges()"
                        data-bs-dismiss="modal"
                      >
                        Guardar Cambios
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
        </div>
    </div>
    <ng-template #noComent>
      <div>
        <h4 class="fw-bold">Vaya .... esta un poco vacio este lugar</h4>
        <div class="imagecontainer">
          <img class="small-image text-center" src="https://i.imgur.com/dqC0xkL.png">
        </div>
        <p class="fw-bold text-primary">¿porque no animarlo un poco?</p>
      </div>
    </ng-template>
    <form #ratingForm="ngForm" (ngSubmit)="submitRating(ratingForm)" *ngIf="existRating===false">
      <div class="row d-flex justify-content-center p-5">
        <div class="row">
          <div class="col-2 d-flex justify-content-center align-items-center">
            <div>
              <img *ngIf="profileImageUrl; else defaultImage" [src]="profileImageUrl" alt="Profile Image"
                class="profile-image rounded-circle" />
              <ng-template #defaultImage>
                <img src="https://banffventureforum.com/wp-content/uploads/2019/08/no-photo-icon-22.png"
                  alt="Profile Image" class="profile-image rounded-circle" />
              </ng-template>
            </div>
          </div>
          <div class="col-8">
            <div class="row">
              <p>{{MyuserProfile.name}} {{MyuserProfile.lastname}}</p>
            </div>
            <div class="row">
              <textarea class="form-control" rows="3" name="comment" [(ngModel)]="comment" required
                placeholder="Escribe un comentario" maxlength="250"></textarea>
              <small class="text-muted">
                <span>{{ 250 - (comment.length || 0) }} caracteres restantes</span>
              </small>
            </div>

          </div>
          <div class="col-2 d-flex align-items-center justify-content-center">
            <button class="btn btn-primary" type="submit" [disabled]="ratingForm.invalid">
              Publicar
            </button>
          </div>
        </div>
      </div>
    </form>
  </div>
</div>